<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--<mapper namespace="com.ztgm.tasktransferplat.dao.plus.OrderinfoMapper">-->
  <resultMap id="BaseResultMap" type="com.ztgm.tasktransferplat.pojo.Orderinfo">
    <id column="Id" jdbcType="INTEGER" property="id" />
    <result column="ProjectId" jdbcType="INTEGER" property="projectId" />
    <result column="OrderNo" jdbcType="VARCHAR" property="orderNo" />
    <result column="OrderState" jdbcType="INTEGER" property="orderState" />
    <result column="CreateTime" jdbcType="VARCHAR" property="createTime" />
    <result column="CreateUserId" jdbcType="VARCHAR" property="createUserId" />
    <result column="CreateRemark" jdbcType="VARCHAR" property="createRemark" />
    <result column="PaymentType" jdbcType="INTEGER" property="paymentType" />
    <result column="ServerType" jdbcType="INTEGER" property="serverType" />
    <result column="LockNum" jdbcType="INTEGER" property="lockNum" />
    <result column="AppointmentTime" jdbcType="VARCHAR" property="appointmentTime" />
    <result column="CustName" jdbcType="VARCHAR" property="custName" />
    <result column="CustPhone" jdbcType="VARCHAR" property="custPhone" />
    <result column="CustAddress" jdbcType="INTEGER" property="custAddress" />
    <result column="CustAddressDetail" jdbcType="VARCHAR" property="custAddressDetail" />
    <result column="LockerId" jdbcType="INTEGER" property="lockerId" />
    <result column="ReceiveTime" jdbcType="VARCHAR" property="receiveTime" />
    <result column="DoneTime" jdbcType="VARCHAR" property="doneTime" />
    <result column="AccountTime" jdbcType="VARCHAR" property="accountTime" />
    <result column="LockerBasePrice" jdbcType="DECIMAL" property="lockerBasePrice" />
    <result column="SellerId" jdbcType="INTEGER" property="sellerId" />
    <result column="SellerBasePrice" jdbcType="INTEGER" property="sellerBasePrice" />
    <result column="SellerInnerId" jdbcType="VARCHAR" property="sellerInnerId" />
    <result column="SellerInnerData" jdbcType="VARCHAR" property="sellerInnerData" />
    <result column="LockerTotalPrice" jdbcType="DECIMAL" property="lockerTotalPrice" />
    <result column="SellerTotalPrice" jdbcType="INTEGER" property="sellerTotalPrice" />
    <result column="DataState" jdbcType="INTEGER" property="dataState" />
    <result column="ServiceScore" jdbcType="INTEGER" property="serviceScore" />
    <result column="CompanyId" jdbcType="INTEGER" property="companyId" />
  </resultMap>
  <sql id="Base_Column_List">
    Id, ProjectId, OrderNo, OrderState, CreateTime, CreateUserId, CreateRemark, PaymentType, 
    ServerType, LockNum, AppointmentTime, CustName, CustPhone, CustAddress, CustAddressDetail, 
    LockerId, ReceiveTime, DoneTime, AccountTime, LockerBasePrice, SellerId, SellerBasePrice, 
    SellerInnerId, SellerInnerData, LockerTotalPrice, SellerTotalPrice, DataState, ServiceScore, 
    CompanyId
  </sql>
  

  
  
  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from status
    where Id = #{id,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    delete from status
    where Id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insertSelective" parameterType="com.ztgm.tasktransferplat.pojo.Orderinfo">
    insert into status
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        Id,
      </if>
      <if test="projectId != null">
        ProjectId,
      </if>
      <if test="orderNo != null">
        OrderNo,
      </if>
      <if test="orderState != null">
        OrderState,
      </if>
      <if test="createTime != null">
        CreateTime,
      </if>
      <if test="createUserId != null">
        CreateUserId,
      </if>
      <if test="createRemark != null">
        CreateRemark,
      </if>
      <if test="paymentType != null">
        PaymentType,
      </if>
      <if test="serverType != null">
        ServerType,
      </if>
      <if test="lockNum != null">
        LockNum,
      </if>
      <if test="appointmentTime != null">
        AppointmentTime,
      </if>
      <if test="custName != null">
        CustName,
      </if>
      <if test="custPhone != null">
        CustPhone,
      </if>
      <if test="custAddress != null">
        CustAddress,
      </if>
      <if test="custAddressDetail != null">
        CustAddressDetail,
      </if>
      <if test="lockerId != null">
        LockerId,
      </if>
      <if test="receiveTime != null">
        ReceiveTime,
      </if>
      <if test="doneTime != null">
        DoneTime,
      </if>
      <if test="accountTime != null">
        AccountTime,
      </if>
      <if test="lockerBasePrice != null">
        LockerBasePrice,
      </if>
      <if test="sellerId != null">
        SellerId,
      </if>
      <if test="sellerBasePrice != null">
        SellerBasePrice,
      </if>
      <if test="sellerInnerId != null">
        SellerInnerId,
      </if>
      <if test="sellerInnerData != null">
        SellerInnerData,
      </if>
      <if test="lockerTotalPrice != null">
        LockerTotalPrice,
      </if>
      <if test="sellerTotalPrice != null">
        SellerTotalPrice,
      </if>
      <if test="dataState != null">
        DataState,
      </if>
      <if test="serviceScore != null">
        ServiceScore,
      </if>
      <if test="companyId != null">
        CompanyId,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=INTEGER},
      </if>
      <if test="projectId != null">
        #{projectId,jdbcType=INTEGER},
      </if>
      <if test="orderNo != null">
        #{orderNo,jdbcType=VARCHAR},
      </if>
      <if test="orderState != null">
        #{orderState,jdbcType=INTEGER},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=VARCHAR},
      </if>
      <if test="createUserId != null">
        #{createUserId,jdbcType=VARCHAR},
      </if>
      <if test="createRemark != null">
        #{createRemark,jdbcType=VARCHAR},
      </if>
      <if test="paymentType != null">
        #{paymentType,jdbcType=INTEGER},
      </if>
      <if test="serverType != null">
        #{serverType,jdbcType=INTEGER},
      </if>
      <if test="lockNum != null">
        #{lockNum,jdbcType=INTEGER},
      </if>
      <if test="appointmentTime != null">
        #{appointmentTime,jdbcType=VARCHAR},
      </if>
      <if test="custName != null">
        #{custName,jdbcType=VARCHAR},
      </if>
      <if test="custPhone != null">
        #{custPhone,jdbcType=VARCHAR},
      </if>
      <if test="custAddress != null">
        #{custAddress,jdbcType=INTEGER},
      </if>
      <if test="custAddressDetail != null">
        #{custAddressDetail,jdbcType=VARCHAR},
      </if>
      <if test="lockerId != null">
        #{lockerId,jdbcType=INTEGER},
      </if>
      <if test="receiveTime != null">
        #{receiveTime,jdbcType=VARCHAR},
      </if>
      <if test="doneTime != null">
        #{doneTime,jdbcType=VARCHAR},
      </if>
      <if test="accountTime != null">
        #{accountTime,jdbcType=VARCHAR},
      </if>
      <if test="lockerBasePrice != null">
        #{lockerBasePrice,jdbcType=DECIMAL},
      </if>
      <if test="sellerId != null">
        #{sellerId,jdbcType=INTEGER},
      </if>
      <if test="sellerBasePrice != null">
        #{sellerBasePrice,jdbcType=INTEGER},
      </if>
      <if test="sellerInnerId != null">
        #{sellerInnerId,jdbcType=VARCHAR},
      </if>
      <if test="sellerInnerData != null">
        #{sellerInnerData,jdbcType=VARCHAR},
      </if>
      <if test="lockerTotalPrice != null">
        #{lockerTotalPrice,jdbcType=DECIMAL},
      </if>
      <if test="sellerTotalPrice != null">
        #{sellerTotalPrice,jdbcType=INTEGER},
      </if>
      <if test="dataState != null">
        #{dataState,jdbcType=INTEGER},
      </if>
      <if test="serviceScore != null">
        #{serviceScore,jdbcType=INTEGER},
      </if>
      <if test="companyId != null">
        #{companyId,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.ztgm.tasktransferplat.pojo.Orderinfo">
    update status
    <set>
      <if test="projectId != null">
        ProjectId = #{projectId,jdbcType=INTEGER},
      </if>
      <if test="orderNo != null">
        OrderNo = #{orderNo,jdbcType=VARCHAR},
      </if>
      <if test="orderState != null">
        OrderState = #{orderState,jdbcType=INTEGER},
      </if>
      <if test="createTime != null">
        CreateTime = #{createTime,jdbcType=VARCHAR},
      </if>
      <if test="createUserId != null">
        CreateUserId = #{createUserId,jdbcType=VARCHAR},
      </if>
      <if test="createRemark != null">
        CreateRemark = #{createRemark,jdbcType=VARCHAR},
      </if>
      <if test="paymentType != null">
        PaymentType = #{paymentType,jdbcType=INTEGER},
      </if>
      <if test="serverType != null">
        ServerType = #{serverType,jdbcType=INTEGER},
      </if>
      <if test="lockNum != null">
        LockNum = #{lockNum,jdbcType=INTEGER},
      </if>
      <if test="appointmentTime != null">
        AppointmentTime = #{appointmentTime,jdbcType=VARCHAR},
      </if>
      <if test="custName != null">
        CustName = #{custName,jdbcType=VARCHAR},
      </if>
      <if test="custPhone != null">
        CustPhone = #{custPhone,jdbcType=VARCHAR},
      </if>
      <if test="custAddress != null">
        CustAddress = #{custAddress,jdbcType=INTEGER},
      </if>
      <if test="custAddressDetail != null">
        CustAddressDetail = #{custAddressDetail,jdbcType=VARCHAR},
      </if>
      <if test="lockerId != null">
        LockerId = #{lockerId,jdbcType=INTEGER},
      </if>
      <if test="receiveTime != null">
        ReceiveTime = #{receiveTime,jdbcType=VARCHAR},
      </if>
      <if test="doneTime != null">
        DoneTime = #{doneTime,jdbcType=VARCHAR},
      </if>
      <if test="accountTime != null">
        AccountTime = #{accountTime,jdbcType=VARCHAR},
      </if>
      <if test="lockerBasePrice != null">
        LockerBasePrice = #{lockerBasePrice,jdbcType=DECIMAL},
      </if>
      <if test="sellerId != null">
        SellerId = #{sellerId,jdbcType=INTEGER},
      </if>
      <if test="sellerBasePrice != null">
        SellerBasePrice = #{sellerBasePrice,jdbcType=INTEGER},
      </if>
      <if test="sellerInnerId != null">
        SellerInnerId = #{sellerInnerId,jdbcType=VARCHAR},
      </if>
      <if test="sellerInnerData != null">
        SellerInnerData = #{sellerInnerData,jdbcType=VARCHAR},
      </if>
      <if test="lockerTotalPrice != null">
        LockerTotalPrice = #{lockerTotalPrice,jdbcType=DECIMAL},
      </if>
      <if test="sellerTotalPrice != null">
        SellerTotalPrice = #{sellerTotalPrice,jdbcType=INTEGER},
      </if>
      <if test="dataState != null">
        DataState = #{dataState,jdbcType=INTEGER},
      </if>
      <if test="serviceScore != null">
        ServiceScore = #{serviceScore,jdbcType=INTEGER},
      </if>
      <if test="companyId != null">
        CompanyId = #{companyId,jdbcType=INTEGER},
      </if>
    </set>
    where Id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.ztgm.tasktransferplat.pojo.Orderinfo">
    update status
    set ProjectId = #{projectId,jdbcType=INTEGER},
      OrderNo = #{orderNo,jdbcType=VARCHAR},
      OrderState = #{orderState,jdbcType=INTEGER},
      CreateTime = #{createTime,jdbcType=VARCHAR},
      CreateUserId = #{createUserId,jdbcType=VARCHAR},
      CreateRemark = #{createRemark,jdbcType=VARCHAR},
      PaymentType = #{paymentType,jdbcType=INTEGER},
      ServerType = #{serverType,jdbcType=INTEGER},
      LockNum = #{lockNum,jdbcType=INTEGER},
      AppointmentTime = #{appointmentTime,jdbcType=VARCHAR},
      CustName = #{custName,jdbcType=VARCHAR},
      CustPhone = #{custPhone,jdbcType=VARCHAR},
      CustAddress = #{custAddress,jdbcType=INTEGER},
      CustAddressDetail = #{custAddressDetail,jdbcType=VARCHAR},
      LockerId = #{lockerId,jdbcType=INTEGER},
      ReceiveTime = #{receiveTime,jdbcType=VARCHAR},
      DoneTime = #{doneTime,jdbcType=VARCHAR},
      AccountTime = #{accountTime,jdbcType=VARCHAR},
      LockerBasePrice = #{lockerBasePrice,jdbcType=DECIMAL},
      SellerId = #{sellerId,jdbcType=INTEGER},
      SellerBasePrice = #{sellerBasePrice,jdbcType=INTEGER},
      SellerInnerId = #{sellerInnerId,jdbcType=VARCHAR},
      SellerInnerData = #{sellerInnerData,jdbcType=VARCHAR},
      LockerTotalPrice = #{lockerTotalPrice,jdbcType=DECIMAL},
      SellerTotalPrice = #{sellerTotalPrice,jdbcType=INTEGER},
      DataState = #{dataState,jdbcType=INTEGER},
      ServiceScore = #{serviceScore,jdbcType=INTEGER},
      CompanyId = #{companyId,jdbcType=INTEGER}
    where Id = #{id,jdbcType=INTEGER}
  </update>
  


<select id="selectList"
	resultMap="BaseResultMap"
	parameterType="com.ztgm.tasktransferplat.pojo.Orderinfo">
	select
	<include refid="Base_Column_List" />
	from status c

	where 1=1 and DataState=1
	<if test=" id !=null and id !='' ">
		and c.id = #{id}
	</if>
	
	<if test="type == 0">
	<![CDATA[and (orderState >= 1 AND orderState < 99) ]]> 
	</if>
	<if test="type == 1">
      <![CDATA[ and  orderState >= 101 AND orderState < 199 ]]> 
      </if>
      <if test="type == 2">
       <![CDATA[ and (orderState >= 201 AND orderState < 399)  ]]> 
      </if>
       <if test="type == 3">
     <![CDATA[   and  orderState >= 301 AND orderState < 399 ]]> 
      </if>
      
      <if test="type == 4">
      <![CDATA[  and  orderState >= 401 AND orderState < 499 ]]> 
      </if>
 	<if test="type == 5">
      <![CDATA[  and  orderState >= 501 AND orderState < 599 ]]> 
      </if>

</select>



     <select id="selectPage" resultType="com.ztgm.tasktransferplat.pojo.Orderinfo">
      SELECT <include refid="Base_Column_List"/> FROM status WHERE 1=1
   <if test="type == 1">
      <![CDATA[ and  orderState >= 101 AND orderState < 199 ]]> 
      </if>
      <if test="type == 2">
        <![CDATA[ and ( (orderState >= 201 AND orderState < 399) OR (orderState >= 1 AND orderState < 99) ) ]]> 
      </if>
      <if test="type == 3">
      <![CDATA[   and  orderState >= 401 AND orderState < 599]]> 
      </if>
   </select>




  <select id="selectListByComplete" resultType="com.ztgm.tasktransferplat.pojo.Orderinfo"
          resultMap="BaseResultMap">

    select
    c.*,t.ChangeValueLocker price
    from status c left join t_orderinfo_attach_money_detail t on c.Id=t.OrderinfoId

    where c.OrderState between 500 and 600
    <if test=" companyId !=null and companyId !='' ">
      and c.companyId = #{companyId}
    </if>

    <if test=" orderNo !=null and orderNo !='' ">
      and c.OrderNo = #{orderNo}
    </if>
    <if test=" serverType !=null and serverType !='' ">
      and c.ServerType = #{serverType}
    </if>
  </select>
  <select id="selectCountNum" resultType="java.lang.Integer">
    select count(id) FROM   status where ProjectId=#{param1}
  </select>

  <select id="selectPointList" resultType="java.lang.Integer" resultMap="BaseResultMap">
    select
    *
    from status
    where LockerId=#{id}
  </select>
  <select id="selectMoneyList" resultType="com.ztgm.tasktransferplat.pojo.Orderinfo">
    select
    *
    from status
    where LockerId=#{id}
    order by AccountTime
  </select>


  <delete id="delete"
	parameterType="com.ztgm.tasktransferplat.pojo.Orderinfo">
	delete from status

	where id = #{id,jdbcType=VARCHAR}

</delete>

<select id="selectOrderStatusStasticList"  resultType="com.ztgm.tasktransferplat.pojo.Orderinfo">
  
select  left(OrderState, 1) type ,date_format( t.CreateTime,'%Y-%m')  month, count(*) num from t_orderinfo t where DataState=1


<if test=" companyId !=null and  companyId !='' ">
 and t.CompanyId is not null  
 </if>
 <if test=" companyId ==null or  companyId =='' ">
   and t.CompanyId is null
 </if>

   <if test=" month!=null and month!='' ">
and date_format( t.CreateTime,'%Y-%m') =#{month}
</if>

group by  left(OrderState, 1)

order by count(*) desc

  </select>
  

</mapper>
